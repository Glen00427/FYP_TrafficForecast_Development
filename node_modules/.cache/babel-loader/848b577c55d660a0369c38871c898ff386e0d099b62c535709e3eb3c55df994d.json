{"ast":null,"code":"import AuthGate from\"./components/AuthGate\";import React,{useState,useEffect}from\"react\";import TrafficAlerts from\"./components/TrafficAlerts\";import TrafficMap from\"./components/TrafficMap\";import SideMenu from\"./components/SideMenu\";import SavedRoutes from\"./components/SavedRoutes\";import NotificationsSettings from\"./components/UserNotifications\";import CreateUserAccount from\"./components/CreateUserAccount\";import CreateAccountSuccess from\"./components/CreateAccountSuccess\";import CreateUserLearnMore from\"./components/CreateUserLearnMore\";import AdminSideMenu from\"./components/AdminSideMenu\";import AdminDashboard from\"./components/AdminDashboard\";import UserSignInForm from\"./components/UserSignInForm\";import UserSignInSuccess from\"./components/UserSignInSuccess\";import{supabase}from\"./lib/supabaseClient\";import FloatingThemeToggle from\"./components/FloatingThemeToggle\";import FloatingMenuButton from\"./components/FloatingMenuButton\";import RoutePreviewSheet from\"./components/RoutePreviewSheet\";import FloatingReportButton from\"./components/FloatingReportButton\";import IncidentReportForm from\"./components/IncidentReportForm\";import{saveIncidentReport}from\"./components/saveIncident\";import NotificationIcon from\"./components/NotificationIcon\";import LiveNotifications from\"./components/LiveNotifications\";import ReportIncidentSubmit from\"./components/ReportIncidentSubmit\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function App(){const[route,setRoute]=useState(null);const[origin,setOrigin]=useState(null);const[destination,setDestination]=useState(null);const[menuOpen,setMenuOpen]=useState(false);// auth & gate\nconst[user,setUser]=useState(null);const[guestAccess,setGuestAccess]=useState(false);// sign-up flow\nconst[accountOpen,setAccountOpen]=useState(false);const[createAccountSuccess,setCreateAccountSuccess]=useState(false);const[learnOpen,setLearnOpen]=useState(false);// sign-in flow\nconst[signInOpen,setSignInOpen]=useState(false);const[signInSuccessOpen,setSignInSuccessOpen]=useState(false);// nav\nconst[activePage,setActivePage]=useState(\"live\");// ðŸ†• incident form + success modal\nconst[incidentOpen,setIncidentOpen]=useState(false);const[submitOpen,setSubmitOpen]=useState(false);const[notifOpen,setNotifOpen]=useState(false);// theme\nconst[theme,setTheme]=useState(()=>localStorage.getItem(\"theme\")||\"light\");const toggleTheme=()=>{setTheme(t=>{const next=t===\"light\"?\"dark\":\"light\";localStorage.setItem(\"theme\",next);return next;});};// map remount\nconst[mapEpoch,setMapEpoch]=useState(0);const bumpMap=()=>{setMapEpoch(e=>e+1);setTimeout(()=>window.dispatchEvent(new Event(\"resize\")),0);};const openMenu=()=>setMenuOpen(true);const closeMenu=()=>setMenuOpen(false);const isAdmin=!!user&&user.role===\"admin\";const isGuest=!user;const gateBlocking=!user&&!guestAccess;const signupFlowOpen=accountOpen||learnOpen||createAccountSuccess;const gateOpen=gateBlocking&&!signupFlowOpen;useEffect(()=>{if(isGuest&&(activePage===\"saved\"||activePage===\"profile\")){setActivePage(\"live\");}},[isGuest,activePage]);useEffect(()=>{if(isAdmin)setActivePage(\"dashboard\");},[isAdmin]);function handleAuthed(u){var _ref,_u$id,_u$name,_u$email,_u$phone,_u$role;const appUser={id:(_ref=(_u$id=u===null||u===void 0?void 0:u.id)!==null&&_u$id!==void 0?_u$id:u===null||u===void 0?void 0:u.userid)!==null&&_ref!==void 0?_ref:\"local\",name:(_u$name=u===null||u===void 0?void 0:u.name)!==null&&_u$name!==void 0?_u$name:\"\",email:(_u$email=u===null||u===void 0?void 0:u.email)!==null&&_u$email!==void 0?_u$email:\"\",phone:(_u$phone=u===null||u===void 0?void 0:u.phone)!==null&&_u$phone!==void 0?_u$phone:\"\",role:(_u$role=u===null||u===void 0?void 0:u.role)!==null&&_u$role!==void 0?_u$role:\"user\"};setUser(appUser);setActivePage(\"live\");setSignInSuccessOpen(true);setSignInOpen(false);setMenuOpen(false);bumpMap();}async function geocode(query){const url=\"https://nominatim.openstreetmap.org/search?format=json&q=\".concat(encodeURIComponent(query),\"&limit=1\");const res=await fetch(url,{headers:{\"Accept-Language\":\"en\"}});const data=await res.json();if(!Array.isArray(data)||!data[0]){throw new Error(\"Location not found: \".concat(query));}return[parseFloat(data[0].lon),parseFloat(data[0].lat)];}async function planRoute(from,to){if(!from||!to){alert(\"Please enter both origin and destination.\");return;}try{var _json$routes;const[fromCoord,toCoord]=await Promise.all([geocode(from),geocode(to)]);setOrigin(fromCoord);setDestination(toCoord);const res=await fetch(\"https://router.project-osrm.org/route/v1/driving/\".concat(fromCoord[0],\",\").concat(fromCoord[1],\";\").concat(toCoord[0],\",\").concat(toCoord[1],\"?overview=full&geometries=geojson\"));const json=await res.json();const r=json===null||json===void 0?void 0:(_json$routes=json.routes)===null||_json$routes===void 0?void 0:_json$routes[0];if(!r)throw new Error(\"Route not found\");setRoute(r.geometry);const mins=Math.round(r.duration/60);const km=(r.distance/1000).toFixed(1);alert(\"Route ready: \".concat(mins,\" min, \").concat(km,\" km\"));}catch(err){console.error(err);alert(err.message||\"Could not plan route.\");}}async function handleCreateAccount(_ref2){let{name,email,phone,password}=_ref2;const emailNorm=(email!==null&&email!==void 0?email:\"\").trim().toLowerCase();const{error}=await supabase.from(\"users\").insert([{name,email:emailNorm,phone,password}]).select().single();if(error){console.error(error);alert(\"Create failed: \".concat(error.message));return;}setAccountOpen(false);setCreateAccountSuccess(true);}function openLearnPage(){setAccountOpen(false);setLearnOpen(true);try{window.history.pushState({view:\"learn\"},\"\");const onPop=()=>{setLearnOpen(false);setAccountOpen(true);window.removeEventListener(\"popstate\",onPop);};window.addEventListener(\"popstate\",onPop,{once:true});}catch(_unused){}}function closeLearnGoBack(){setLearnOpen(false);setAccountOpen(true);try{var _window$history$state;if(((_window$history$state=window.history.state)===null||_window$history$state===void 0?void 0:_window$history$state.view)===\"learn\")window.history.back();}catch(_unused2){}}async function handleLogout(){try{const{doLogout}=await import(\"./components/logout\");await doLogout();}catch(_){}setUser(null);setActivePage(\"live\");setMenuOpen(false);try{localStorage.removeItem(\"role\");}catch(_unused3){}bumpMap();}// ===== EARLY RETURNS =====\nif(gateBlocking&&signupFlowOpen){return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",\"data-theme\":theme,children:[accountOpen&&/*#__PURE__*/_jsx(CreateUserAccount,{open:accountOpen,onClose:()=>setAccountOpen(false),onLearnMore:()=>{setAccountOpen(false);setLearnOpen(true);},onSubmit:handleCreateAccount,fullScreen:true}),learnOpen&&/*#__PURE__*/_jsx(CreateUserLearnMore,{open:learnOpen,onClose:()=>setLearnOpen(false),onGoBack:()=>{setLearnOpen(false);setAccountOpen(true);},fullScreen:true}),createAccountSuccess&&/*#__PURE__*/_jsx(CreateAccountSuccess,{open:true,onClose:()=>setCreateAccountSuccess(false),onLogin:()=>{setCreateAccountSuccess(false);}})]});}if(gateOpen){return/*#__PURE__*/_jsx(\"div\",{className:\"app\",\"data-theme\":theme,children:/*#__PURE__*/_jsx(AuthGate,{appName:\"SG Traffic Forecast\",onAuthed:handleAuthed,onGuest:()=>{setGuestAccess(true);bumpMap();},onSignUp:()=>setAccountOpen(true)})});}// ===== NORMAL APP =====\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"app\",\"data-theme\":theme,children:[isAdmin?/*#__PURE__*/_jsx(AdminSideMenu,{open:menuOpen,onClose:closeMenu,active:activePage,onNavigate:setActivePage}):/*#__PURE__*/_jsx(SideMenu,{open:menuOpen,onClose:closeMenu,activePage:activePage,onNavigate:setActivePage,isGuest:!user,onCreateAccount:()=>setAccountOpen(true),onSignIn:()=>setSignInOpen(true),onLogout:handleLogout}),/*#__PURE__*/_jsxs(\"section\",{className:\"page page-live \".concat(activePage===\"live\"?\"is-active\":\"\"),\"aria-hidden\":activePage!==\"live\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"map-wrapper\",children:[/*#__PURE__*/_jsx(TrafficMap,{route:route,origin:origin,destination:destination,theme:theme},mapEpoch),/*#__PURE__*/_jsxs(\"div\",{className:\"map-overlays-tl\",children:[/*#__PURE__*/_jsx(FloatingMenuButton,{onOpenMenu:openMenu}),!!user&&/*#__PURE__*/_jsx(NotificationIcon,{onClick:()=>setActivePage(\"profile\")}),!!user&&/*#__PURE__*/_jsx(NotificationIcon,{onClick:()=>setNotifOpen(true)})]}),/*#__PURE__*/_jsx(FloatingThemeToggle,{theme:theme,onToggle:toggleTheme}),!!user&&/*#__PURE__*/_jsx(FloatingReportButton,{onClick:()=>setIncidentOpen(true)}),/*#__PURE__*/_jsx(IncidentReportForm,{open:incidentOpen,onCancel:()=>setIncidentOpen(false),onSubmit:async form=>{try{await saveIncidentReport({form,user});setIncidentOpen(false);setSubmitOpen(true);// ðŸ†• show success modal\n}catch(e){console.error(e);alert(e.message||\"Failed to save incident\");}}}),/*#__PURE__*/_jsx(ReportIncidentSubmit,{open:submitOpen,onClose:()=>setSubmitOpen(false),autoCloseMs:1800}),/*#__PURE__*/_jsx(LiveNotifications,{open:notifOpen,onClose:()=>setNotifOpen(false),items:[{id:\"n1\",when:\"10 min ago\",title:\"Severe Traffic incident on KPE\",desc:\"Severe traffic collision on KPE involving 5 vehicles.\"},{id:\"n2\",when:\"2 hours ago\",title:\"Road closure along PIE\",desc:\"Road closure along PIE Exit 2 from 12am - 5am on 21 Sep 2025\"}]})]}),/*#__PURE__*/_jsx(RoutePreviewSheet,{isGuest:!user,onSubmit:(from,to,options)=>{console.log(\"Preview requested:\",{from,to,options});}})]}),/*#__PURE__*/_jsx(\"section\",{className:\"page page-saved \".concat(activePage===\"saved\"?\"is-active\":\"\"),\"aria-hidden\":activePage!==\"saved\",children:/*#__PURE__*/_jsx(SavedRoutes,{onClose:()=>setActivePage(\"live\")})}),/*#__PURE__*/_jsx(\"section\",{className:\"page page-profile \".concat(activePage===\"profile\"?\"is-active\":\"\"),\"aria-hidden\":activePage!==\"profile\",children:/*#__PURE__*/_jsx(NotificationsSettings,{theme:theme,onToggleTheme:toggleTheme,onClose:()=>setActivePage(\"live\")})}),!!user&&user.role===\"admin\"&&/*#__PURE__*/_jsx(\"section\",{className:\"page page-admin \".concat(activePage===\"dashboard\"?\"is-active\":\"\"),\"aria-hidden\":activePage!==\"dashboard\",children:/*#__PURE__*/_jsx(AdminDashboard,{})}),/*#__PURE__*/_jsx(CreateUserAccount,{open:accountOpen,onClose:()=>setAccountOpen(false),onLearnMore:()=>{setAccountOpen(false);setLearnOpen(true);},onSubmit:handleCreateAccount,fullScreen:true}),/*#__PURE__*/_jsx(CreateAccountSuccess,{open:createAccountSuccess,onClose:()=>setCreateAccountSuccess(false),onLogin:()=>{setCreateAccountSuccess(false);handleAuthed({id:\"demo\",fname:\"New\",role:\"user\"});}}),/*#__PURE__*/_jsx(CreateUserLearnMore,{open:learnOpen,onClose:()=>setLearnOpen(false),onGoBack:()=>{setLearnOpen(false);setAccountOpen(true);},fullScreen:true}),/*#__PURE__*/_jsx(UserSignInForm,{open:signInOpen,onClose:()=>setSignInOpen(false),onSuccess:payload=>{var _payload$user;const src=(_payload$user=payload===null||payload===void 0?void 0:payload.user)!==null&&_payload$user!==void 0?_payload$user:payload;handleAuthed(src);setSignInOpen(false);setSignInSuccessOpen(true);setActivePage(\"live\");}}),/*#__PURE__*/_jsx(UserSignInSuccess,{open:signInSuccessOpen,onClose:()=>setSignInSuccessOpen(false),onContinue:()=>setSignInSuccessOpen(false),autoCloseMs:1800})]});}","map":{"version":3,"names":["AuthGate","React","useState","useEffect","TrafficAlerts","TrafficMap","SideMenu","SavedRoutes","NotificationsSettings","CreateUserAccount","CreateAccountSuccess","CreateUserLearnMore","AdminSideMenu","AdminDashboard","UserSignInForm","UserSignInSuccess","supabase","FloatingThemeToggle","FloatingMenuButton","RoutePreviewSheet","FloatingReportButton","IncidentReportForm","saveIncidentReport","NotificationIcon","LiveNotifications","ReportIncidentSubmit","jsx","_jsx","jsxs","_jsxs","App","route","setRoute","origin","setOrigin","destination","setDestination","menuOpen","setMenuOpen","user","setUser","guestAccess","setGuestAccess","accountOpen","setAccountOpen","createAccountSuccess","setCreateAccountSuccess","learnOpen","setLearnOpen","signInOpen","setSignInOpen","signInSuccessOpen","setSignInSuccessOpen","activePage","setActivePage","incidentOpen","setIncidentOpen","submitOpen","setSubmitOpen","notifOpen","setNotifOpen","theme","setTheme","localStorage","getItem","toggleTheme","t","next","setItem","mapEpoch","setMapEpoch","bumpMap","e","setTimeout","window","dispatchEvent","Event","openMenu","closeMenu","isAdmin","role","isGuest","gateBlocking","signupFlowOpen","gateOpen","handleAuthed","u","_ref","_u$id","_u$name","_u$email","_u$phone","_u$role","appUser","id","userid","name","email","phone","geocode","query","url","concat","encodeURIComponent","res","fetch","headers","data","json","Array","isArray","Error","parseFloat","lon","lat","planRoute","from","to","alert","_json$routes","fromCoord","toCoord","Promise","all","r","routes","geometry","mins","Math","round","duration","km","distance","toFixed","err","console","error","message","handleCreateAccount","_ref2","password","emailNorm","trim","toLowerCase","insert","select","single","openLearnPage","history","pushState","view","onPop","removeEventListener","addEventListener","once","_unused","closeLearnGoBack","_window$history$state","state","back","_unused2","handleLogout","doLogout","_","removeItem","_unused3","className","children","open","onClose","onLearnMore","onSubmit","fullScreen","onGoBack","onLogin","appName","onAuthed","onGuest","onSignUp","active","onNavigate","onCreateAccount","onSignIn","onLogout","onOpenMenu","onClick","onToggle","onCancel","form","autoCloseMs","items","when","title","desc","options","log","onToggleTheme","fname","onSuccess","payload","_payload$user","src","onContinue"],"sources":["/workspaces/FYP_TrafficForecast/src/App.js"],"sourcesContent":["import AuthGate from \"./components/AuthGate\";\nimport React, { useState, useEffect } from \"react\";\nimport TrafficAlerts from \"./components/TrafficAlerts\";\nimport TrafficMap from \"./components/TrafficMap\";\nimport SideMenu from \"./components/SideMenu\";\nimport SavedRoutes from \"./components/SavedRoutes\";\nimport NotificationsSettings from \"./components/UserNotifications\";\nimport CreateUserAccount from \"./components/CreateUserAccount\";\nimport CreateAccountSuccess from \"./components/CreateAccountSuccess\";\nimport CreateUserLearnMore from \"./components/CreateUserLearnMore\";\nimport AdminSideMenu from \"./components/AdminSideMenu\";\nimport AdminDashboard from \"./components/AdminDashboard\";\nimport UserSignInForm from \"./components/UserSignInForm\";\nimport UserSignInSuccess from \"./components/UserSignInSuccess\";\nimport { supabase } from \"./lib/supabaseClient\";\nimport FloatingThemeToggle from \"./components/FloatingThemeToggle\";\nimport FloatingMenuButton from \"./components/FloatingMenuButton\";\nimport RoutePreviewSheet from \"./components/RoutePreviewSheet\";\nimport FloatingReportButton from \"./components/FloatingReportButton\";\nimport IncidentReportForm from \"./components/IncidentReportForm\";\nimport { saveIncidentReport } from \"./components/saveIncident\";\nimport NotificationIcon from \"./components/NotificationIcon\";\nimport LiveNotifications from \"./components/LiveNotifications\";\nimport ReportIncidentSubmit from \"./components/ReportIncidentSubmit\";\n\nexport default function App() {\n  const [route, setRoute] = useState(null);\n  const [origin, setOrigin] = useState(null);\n  const [destination, setDestination] = useState(null);\n  const [menuOpen, setMenuOpen] = useState(false);\n\n  // auth & gate\n  const [user, setUser] = useState(null);\n  const [guestAccess, setGuestAccess] = useState(false);\n\n  // sign-up flow\n  const [accountOpen, setAccountOpen] = useState(false);\n  const [createAccountSuccess, setCreateAccountSuccess] = useState(false);\n  const [learnOpen, setLearnOpen] = useState(false);\n\n  // sign-in flow\n  const [signInOpen, setSignInOpen] = useState(false);\n  const [signInSuccessOpen, setSignInSuccessOpen] = useState(false);\n\n  // nav\n  const [activePage, setActivePage] = useState(\"live\");\n\n  // ðŸ†• incident form + success modal\n  const [incidentOpen, setIncidentOpen] = useState(false);\n  const [submitOpen, setSubmitOpen] = useState(false);\n  const [notifOpen, setNotifOpen] = useState(false);\n\n  // theme\n  const [theme, setTheme] = useState(\n    () => localStorage.getItem(\"theme\") || \"light\"\n  );\n  const toggleTheme = () => {\n    setTheme((t) => {\n      const next = t === \"light\" ? \"dark\" : \"light\";\n      localStorage.setItem(\"theme\", next);\n      return next;\n    });\n  };\n\n  // map remount\n  const [mapEpoch, setMapEpoch] = useState(0);\n  const bumpMap = () => {\n    setMapEpoch((e) => e + 1);\n    setTimeout(() => window.dispatchEvent(new Event(\"resize\")), 0);\n  };\n\n  const openMenu = () => setMenuOpen(true);\n  const closeMenu = () => setMenuOpen(false);\n\n  const isAdmin = !!user && user.role === \"admin\";\n  const isGuest = !user;\n  const gateBlocking = !user && !guestAccess;\n  const signupFlowOpen = accountOpen || learnOpen || createAccountSuccess;\n  const gateOpen = gateBlocking && !signupFlowOpen;\n\n  useEffect(() => {\n    if (isGuest && (activePage === \"saved\" || activePage === \"profile\")) {\n      setActivePage(\"live\");\n    }\n  }, [isGuest, activePage]);\n\n  useEffect(() => {\n    if (isAdmin) setActivePage(\"dashboard\");\n  }, [isAdmin]);\n\n  function handleAuthed(u) {\n    const appUser = {\n      id: u?.id ?? u?.userid ?? \"local\",\n      name: u?.name ?? \"\",\n      email: u?.email ?? \"\",\n      phone: u?.phone ?? \"\",\n      role: u?.role ?? \"user\",\n    };\n    setUser(appUser);\n    setActivePage(\"live\");\n    setSignInSuccessOpen(true);\n    setSignInOpen(false);\n    setMenuOpen(false);\n    bumpMap();\n  }\n\n  async function geocode(query) {\n    const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(\n      query\n    )}&limit=1`;\n    const res = await fetch(url, { headers: { \"Accept-Language\": \"en\" } });\n    const data = await res.json();\n    if (!Array.isArray(data) || !data[0]) {\n      throw new Error(`Location not found: ${query}`);\n    }\n    return [parseFloat(data[0].lon), parseFloat(data[0].lat)];\n  }\n\n  async function planRoute(from, to) {\n    if (!from || !to) {\n      alert(\"Please enter both origin and destination.\");\n      return;\n    }\n    try {\n      const [fromCoord, toCoord] = await Promise.all([\n        geocode(from),\n        geocode(to),\n      ]);\n      setOrigin(fromCoord);\n      setDestination(toCoord);\n\n      const res = await fetch(\n        `https://router.project-osrm.org/route/v1/driving/${fromCoord[0]},${fromCoord[1]};${toCoord[0]},${toCoord[1]}?overview=full&geometries=geojson`\n      );\n      const json = await res.json();\n      const r = json?.routes?.[0];\n      if (!r) throw new Error(\"Route not found\");\n\n      setRoute(r.geometry);\n\n      const mins = Math.round(r.duration / 60);\n      const km = (r.distance / 1000).toFixed(1);\n      alert(`Route ready: ${mins} min, ${km} km`);\n    } catch (err) {\n      console.error(err);\n      alert(err.message || \"Could not plan route.\");\n    }\n  }\n\n  async function handleCreateAccount({ name, email, phone, password }) {\n    const emailNorm = (email ?? \"\").trim().toLowerCase();\n\n    const { error } = await supabase\n      .from(\"users\")\n      .insert([{ name, email: emailNorm, phone, password }])\n      .select()\n      .single();\n\n    if (error) {\n      console.error(error);\n      alert(`Create failed: ${error.message}`);\n      return;\n    }\n\n    setAccountOpen(false);\n    setCreateAccountSuccess(true);\n  }\n\n  function openLearnPage() {\n    setAccountOpen(false);\n    setLearnOpen(true);\n    try {\n      window.history.pushState({ view: \"learn\" }, \"\");\n      const onPop = () => {\n        setLearnOpen(false);\n        setAccountOpen(true);\n        window.removeEventListener(\"popstate\", onPop);\n      };\n      window.addEventListener(\"popstate\", onPop, { once: true });\n    } catch {}\n  }\n\n  function closeLearnGoBack() {\n    setLearnOpen(false);\n    setAccountOpen(true);\n    try {\n      if (window.history.state?.view === \"learn\") window.history.back();\n    } catch {}\n  }\n\n  async function handleLogout() {\n    try {\n      const { doLogout } = await import(\"./components/logout\");\n      await doLogout();\n    } catch (_) {}\n\n    setUser(null);\n    setActivePage(\"live\");\n    setMenuOpen(false);\n    try {\n      localStorage.removeItem(\"role\");\n    } catch {}\n    bumpMap();\n  }\n\n  // ===== EARLY RETURNS =====\n  if (gateBlocking && signupFlowOpen) {\n    return (\n      <div className=\"app\" data-theme={theme}>\n        {accountOpen && (\n          <CreateUserAccount\n            open={accountOpen}\n            onClose={() => setAccountOpen(false)}\n            onLearnMore={() => {\n              setAccountOpen(false);\n              setLearnOpen(true);\n            }}\n            onSubmit={handleCreateAccount}\n            fullScreen\n          />\n        )}\n        {learnOpen && (\n          <CreateUserLearnMore\n            open={learnOpen}\n            onClose={() => setLearnOpen(false)}\n            onGoBack={() => {\n              setLearnOpen(false);\n              setAccountOpen(true);\n            }}\n            fullScreen\n          />\n        )}\n        {createAccountSuccess && (\n          <CreateAccountSuccess\n            open\n            onClose={() => setCreateAccountSuccess(false)}\n            onLogin={() => {\n              setCreateAccountSuccess(false);\n            }}\n          />\n        )}\n      </div>\n    );\n  }\n\n  if (gateOpen) {\n    return (\n      <div className=\"app\" data-theme={theme}>\n        <AuthGate\n          appName=\"SG Traffic Forecast\"\n          onAuthed={handleAuthed}\n          onGuest={() => {\n            setGuestAccess(true);\n            bumpMap();\n          }}\n          onSignUp={() => setAccountOpen(true)}\n        />\n      </div>\n    );\n  }\n\n  // ===== NORMAL APP =====\n  return (\n    <div className=\"app\" data-theme={theme}>\n      {isAdmin ? (\n        <AdminSideMenu\n          open={menuOpen}\n          onClose={closeMenu}\n          active={activePage}\n          onNavigate={setActivePage}\n        />\n      ) : (\n        <SideMenu\n          open={menuOpen}\n          onClose={closeMenu}\n          activePage={activePage}\n          onNavigate={setActivePage}\n          isGuest={!user}\n          onCreateAccount={() => setAccountOpen(true)}\n          onSignIn={() => setSignInOpen(true)}\n          onLogout={handleLogout}\n        />\n      )}\n\n      {/* LIVE MAP PAGE */}\n      <section\n        className={`page page-live ${activePage === \"live\" ? \"is-active\" : \"\"}`}\n        aria-hidden={activePage !== \"live\"}\n      >\n        <div className=\"map-wrapper\">\n          <TrafficMap\n            key={mapEpoch}\n            route={route}\n            origin={origin}\n            destination={destination}\n            theme={theme}\n          />\n          <div className=\"map-overlays-tl\">\n            <FloatingMenuButton onOpenMenu={openMenu} />\n            {!!user && (\n              <NotificationIcon onClick={() => setActivePage(\"profile\")} />\n            )}\n            {!!user && <NotificationIcon onClick={() => setNotifOpen(true)} />}\n          </div>\n\n          <FloatingThemeToggle theme={theme} onToggle={toggleTheme} />\n          {!!user && (\n            <FloatingReportButton onClick={() => setIncidentOpen(true)} />\n          )}\n\n          {/* Incident Form modal */}\n          <IncidentReportForm\n            open={incidentOpen}\n            onCancel={() => setIncidentOpen(false)}\n            onSubmit={async (form) => {\n              try {\n                await saveIncidentReport({ form, user });\n                setIncidentOpen(false);\n                setSubmitOpen(true); // ðŸ†• show success modal\n              } catch (e) {\n                console.error(e);\n                alert(e.message || \"Failed to save incident\");\n              }\n            }}\n          />\n\n          {/* ðŸ†• Success modal */}\n          <ReportIncidentSubmit\n            open={submitOpen}\n            onClose={() => setSubmitOpen(false)}\n            autoCloseMs={1800}\n          />\n\n          <LiveNotifications\n            open={notifOpen}\n            onClose={() => setNotifOpen(false)}\n            items={[\n              {\n                id: \"n1\",\n                when: \"10 min ago\",\n                title: \"Severe Traffic incident on KPE\",\n                desc: \"Severe traffic collision on KPE involving 5 vehicles.\",\n              },\n              {\n                id: \"n2\",\n                when: \"2 hours ago\",\n                title: \"Road closure along PIE\",\n                desc: \"Road closure along PIE Exit 2 from 12am - 5am on 21 Sep 2025\",\n              },\n            ]}\n          />\n        </div>\n\n        <RoutePreviewSheet\n          isGuest={!user}\n          onSubmit={(from, to, options) => {\n            console.log(\"Preview requested:\", { from, to, options });\n          }}\n        />\n      </section>\n\n      {/* SAVED ROUTES PAGE */}\n      <section\n        className={`page page-saved ${\n          activePage === \"saved\" ? \"is-active\" : \"\"\n        }`}\n        aria-hidden={activePage !== \"saved\"}\n      >\n        <SavedRoutes onClose={() => setActivePage(\"live\")} />\n      </section>\n\n      {/* PROFILE / NOTIFICATIONS PAGE */}\n      <section\n        className={`page page-profile ${\n          activePage === \"profile\" ? \"is-active\" : \"\"\n        }`}\n        aria-hidden={activePage !== \"profile\"}\n      >\n        <NotificationsSettings\n          theme={theme}\n          onToggleTheme={toggleTheme}\n          onClose={() => setActivePage(\"live\")}\n        />\n      </section>\n\n      {/* ADMIN: DASHBOARD */}\n      {!!user && user.role === \"admin\" && (\n        <section\n          className={`page page-admin ${\n            activePage === \"dashboard\" ? \"is-active\" : \"\"\n          }`}\n          aria-hidden={activePage !== \"dashboard\"}\n        >\n          <AdminDashboard />\n        </section>\n      )}\n\n      {/* Modals */}\n      <CreateUserAccount\n        open={accountOpen}\n        onClose={() => setAccountOpen(false)}\n        onLearnMore={() => {\n          setAccountOpen(false);\n          setLearnOpen(true);\n        }}\n        onSubmit={handleCreateAccount}\n        fullScreen\n      />\n      <CreateAccountSuccess\n        open={createAccountSuccess}\n        onClose={() => setCreateAccountSuccess(false)}\n        onLogin={() => {\n          setCreateAccountSuccess(false);\n          handleAuthed({ id: \"demo\", fname: \"New\", role: \"user\" });\n        }}\n      />\n      <CreateUserLearnMore\n        open={learnOpen}\n        onClose={() => setLearnOpen(false)}\n        onGoBack={() => {\n          setLearnOpen(false);\n          setAccountOpen(true);\n        }}\n        fullScreen\n      />\n      <UserSignInForm\n        open={signInOpen}\n        onClose={() => setSignInOpen(false)}\n        onSuccess={(payload) => {\n          const src = payload?.user ?? payload;\n          handleAuthed(src);\n          setSignInOpen(false);\n          setSignInSuccessOpen(true);\n          setActivePage(\"live\");\n        }}\n      />\n      <UserSignInSuccess\n        open={signInSuccessOpen}\n        onClose={() => setSignInSuccessOpen(false)}\n        onContinue={() => setSignInSuccessOpen(false)}\n        autoCloseMs={1800}\n      />\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}